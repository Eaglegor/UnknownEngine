<scene>

	<constant name="global_log_level" value="debug"/>

	<subsystems>
		<subsystem name="Logger" module="ConsoleLogger">
			<received_messages>
				<message type="Engine.LogMessage">
					<receive_policy type="AnyMessageReceivePolicy"/>
				</message>
			</received_messages>
		</subsystem>
		
		<subsystem name="UserInput" module="SDLWindowManagerPlugin">
			<received_messages>
				<message type="Engine.MainLoop.UpdateFrameMessage"/>
				<message type="Graphics.GUI.GetWindowHandleMessage"/>
			</received_messages>
		</subsystem>
		
		<subsystem name="Graphics" module="OgreRenderSystem">
		
			<dependencies>
				<dependency>UserInput</dependency>
			</dependencies>
		
			<received_messages>
				<message type="Engine.MainLoop.UpdateFrameMessage">
					<receive_policy type="FromSingleSenderMessageReceivePolicy">
						<options_section>
							<option name="sender_name" value="Engine"/>
						</options_section>
					</receive_policy>
				</message>
			</received_messages>
		
			<options_section>
				
				<option name="log_level" value="${global_log_level}"/>

				<option name="separate_rendering_thread" value="false"/>
				
				<options_section name="RenderWindow">
					<option name="type" value="external"/>
					<option name="title" value="TestWindow"/>
					
					<option name="window_name" value="ParserTestWindowName"/>
					<option name="window_title" value="ParserTestWindowTitle"/>
					<option name="window_type" value="external"/>
					
					<option name="width" value="1024"/>
					<option name="height" value="768"/>
					
					<options_section name="window_flags">
						<option name="fullscreen" value="true"/>
					</options_section>
					
				</options_section>
				
				<options_section name="ConfigFiles">
					<option name="ogre_plugins_filename" value="plugins.cfg"/>
					<option name="ogre_log_filename" value="Ogre.log"/>
					<option name="ogre_config_filename" value="ogre.cfg"/>
					<option name="ogre_resources_filename" value="resources.cfg"/>
				</options_section>
				
			</options_section>
			
		</subsystem>
		
		<subsystem name="MeshDataLoader" module="AssimpMeshDataLoader"/>
		
		<subsystem name="SimpleBehavior" module="SimpleBehaviorPlugin">
			<received_messages>
				<message type="Engine.MainLoop.UpdateFrameMessage"/>
				<message type="IO.KeyStateChanged"/>
			</received_messages>
		</subsystem>
		
	</subsystems>

	<entities>

		<entity name="MainCamera">
			<component type="Graphics.Camera" name="Camera">
				<options_section>
					
					<option name="render_window_name" value="TestWindow"/>
					<option name="log_level" value="${global_log_level}"/>
					
					<options_section name="InitialTransform">
						<option name="position" value="Vector3(x:0, y:0, z:50)"/>
						<option name="look_at" value="Vector3(x:0, y:0, z:0)"/>
					</options_section>
					
					<option name="near_clip_distance" value="0.0001"/>
					
				</options_section>
			</component>
		</entity>

		<data_provider name="TeapotMesh" type="Loader.MeshData.AssimpMeshDataLoader">
			<options_section>
				<option name="filename" value="teapot.obj"/>
				<option name="log_level" value="${global_log_level}"/>
				
				<options_section name="Postprocessing">
					<option name="generate_normals" value="true"/>
					<option name="triangulate" value="true"/>
				</options_section>
					
			</options_section>
		</data_provider>
		
		<data_provider name="OgreAdaptedTeapotMesh" type="Loader.OgreMeshPtr.OgreMeshPtrFromMeshDataProvider">
			<options_section>
				<provided_data name="mesh_data_provider" data_provider_name="TeapotMesh"/>
				<option name="log_level" value="${global_log_level}"/>
			</options_section>
		</data_provider>
		
		<entity name="TestRenderable">
			
			<component name="Rotation" type="Behavior.SimpleRotation"/>
			
			<component name="RenderableComponent" type="Graphics.Renderable">
				
				<received_messages>
					<message type="Engine.TransformChangedMessage">
						<receive_policy type="FromSingleSenderMessageReceivePolicy">
							<options_section>
								<option name="sender_name" value="TestRenderable.Rotation"/>
							</options_section>
						</receive_policy>
					</message>
				</received_messages>
				
				<options_section>
					
					<option name="log_level" value="${global_log_level}"/>
					<option name="throw_exception_on_missing_mesh_data" value="true"/>
					
					<provided_data name="mesh_ptr_provider" data_provider_name="OgreAdaptedTeapotMesh"/>
					
					<options_section name="Material">
						<option name="material_name" value="Test"/>
					</options_section>
					
					<options_section name="InitialTransform">
						<option name="position" value="Vector3(x:10, y:0, z:0)"/>
					</options_section>
					
				</options_section>
			</component>
		</entity>
		
		<entity name="TestRenderable2">
			<component name="RenderableComponent" type="Graphics.Renderable">
				<options_section>
					
					<option name="log_level" value="${global_log_level}"/>
					<option name="throw_exception_on_missing_mesh_data" value="true"/>
					
					<provided_data name="mesh_ptr_provider" data_provider_name="OgreAdaptedTeapotMesh"/>
					
					<options_section name="Material">
						<option name="material_name" value="Test"/>
					</options_section>
					
					<options_section name="InitialTransform">
						<option name="position" value="Vector3(x:-10, y:0, z:0)"/>
					</options_section>
					
				</options_section>
			</component>
		</entity>
		
		<entity name="LightEntity">
		
			<component name="LightComponentD" type="Graphics.Light.Directional">

				<received_messages>
					<message type="Engine.TransformChangedMessage">
						<receive_policy type="FromSingleSenderMessageReceivePolicy">
							<options_section>
								<option name="sender_name" value="TestRenderable.Rotation"/>
							</options_section>
						</receive_policy>
					</message>
				</received_messages>
			
				<options_section>
					
					<option name="log_level" value="${global_log_level}"/>
					
					<options_section name="LightSettings">
						<option name="intensity" value="1"/>
						<option name="diffuse_color" value="Colour(r:0, g:1, b:0)"/>
						<option name="specular_color" value="Colour(r:0, g:1, b:0)"/>
					</options_section>
					
					<options_section name="InitialTransform">
						<option name="position" value="Vector3(x:10, y:0, z:100)"/>
						<option name="initial_look_at" value="Vector3(x:-30, y:0, z:-50)"/>
					</options_section>
					
				</options_section>
			</component>
			
			<component name="LightComponentD2" type="Graphics.Light.Directional">
				<options_section>
					
					<option name="log_level" value="${global_log_level}"/>
					
					<options_section name="LightSettings">
						<option name="intensity" value="1"/>
						<option name="diffuse_color" value="Colour(r:0, g:0, b:1)"/>
						<option name="specular_color" value="Colour(r:0, g:0, b:1)"/>
					</options_section>
					
					<options_section name="InitialTransform">
						<option name="position" value="Vector3(x:-10, y:0, z:100)"/>
						<option name="initial_look_at" value="Vector3(x:30, y:0, z:-50)"/>
					</options_section>
					
				</options_section>
			</component>
			
		</entity>
		
	</entities>
	
</scene>